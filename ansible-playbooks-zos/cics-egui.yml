###############################################################################
# Usage:
#  ansible-playbook -i <inventory> <playbook>
#
# Example:
#  ansible-playbook -i inventory cics_egui.yml
#  ansible-playbook -i inventory cics_egui.yml -v
###############################################################################
---
- hosts: ben_s0w1 
  collections:
    - ibm.ibm_zos_core
  gather_facts: no

  vars:
    adcd_ver: Z24C
    high_level_qualifier: IBMUSER
    cics_high_level_qualifier: DFH560

  environment: "{{ environment_vars }}"

  tasks:
    - name: Ping using zos_ping
      zos_ping:
      register: zos_ping_result

    - name: Response from zos_ping
      debug:
        msg: "{{ zos_ping_result }}"
        
###############################################################################
# Usage: 
#  Creating and defining the VSAM data sets.
###############################################################################

    - name: Submit DFH$ECA to create catalog data set and wait for the job to finish.
      zos_job_submit:
        src: "IBMUSER.GIT.JCL.CNTL(DFH$ECA)"
        location: DATA_SET
        wait: true
        wait_time_s: 60
      register: zos_job_submit_result 

    - name: DEBUG(-v) Response from Submit DFH$ECA to create catalog data set and wait for the job to finish.
      debug:
        msg: "{{ zos_job_submit_result }} with verbosity 1"
        verbosity: 1

    - name: Submit DFH$CNF to create configuration data set and wait for the job to finish.
      zos_job_submit:
        src: "IBMUSER.GIT.JCL.CNTL(DFH$ECNF)"
        location: DATA_SET
        wait: true
        wait_time_s: 60
      register: zos_job_submit_result 

    - name: DEBUG(-v) Response from Submit DFH$CNF to create configuration data set and wait for the job to finish.
      debug:
        msg: "{{ zos_job_submit_result }} with verbosity 1"
        verbosity: 1

###############################################################################
# Usage: 
#  submit CICS system definition for zOffice
###############################################################################
     
    - name: Submit CICSCSD to create definition for zOffice and wait for the job to finish.
      zos_job_submit:
        src: IBMUSER.GIT.JCL.CNTL(CICSCSD)
        location: DATA_SET
        wait: true
        wait_time_s: 60
      register: zos_job_submit_result 

    - name: DEBUG(-v) Response from Submit CICSCSD to create definition for zOffice and wait for the job to finish.
      debug:
        msg: "{{ zos_job_submit_result }} with verbosity 1"
        verbosity: 1
